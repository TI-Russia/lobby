!function r(o,a,l){function i(e,t){if(!a[e]){if(!o[e]){var n="function"==typeof require&&require;if(!t&&n)return n(e,!0);if(c)return c(e,!0);throw(t=new Error("Cannot find module '"+e+"'")).code="MODULE_NOT_FOUND",t}n=a[e]={exports:{}},o[e][0].call(n.exports,function(t){return i(o[e][1][t]||t)},n,n.exports,r,o,a,l)}return a[e].exports}for(var c="function"==typeof require&&require,t=0;t<l.length;t++)i(l[t]);return i}({1:[function(t,e,n){"use strict";function l(t){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var r=function(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==l(t)&&"function"!=typeof t)return{default:t};e=i(e);if(e&&e.has(t))return e.get(t);var n,r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in t){var a;"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&((a=o?Object.getOwnPropertyDescriptor(t,n):null)&&(a.get||a.set)?Object.defineProperty(r,n,a):r[n]=t[n])}r.default=t,e&&e.set(t,r);return r}(t("d3"));function i(t){var e,n;return"function"!=typeof WeakMap?null:(e=new WeakMap,n=new WeakMap,(i=function(t){return t?n:e})(t))}t("./tools/burger"),t("./modules/data"),t("./modules/intro"),t("./modules/accordion"),t("./modules/legend"),t("./modules/about"),t("./modules/header"),window.d3=r},{"./modules/about":2,"./modules/accordion":3,"./modules/data":6,"./modules/header":7,"./modules/intro":8,"./modules/legend":10,"./tools/burger":11,d3:"d3"}],2:[function(t,e,n){"use strict";var r,o=(r=t("jquery"))&&r.__esModule?r:{default:r};"page-about"===(0,t("./layout_vars").getLayoutVars)().layout&&(document.documentElement.style.overflowY="auto",(0,o.default)(window).scroll(function(){for(var t=(0,o.default)(document).scrollTop(),e=(0,o.default)("body").find(".md-page-section"),n=0;n<e.length;n++)t+110>(0,o.default)(e[n]).offset().top&&t<(0,o.default)(e[n]).offset().top+(0,o.default)(e[n]).height()-50?(0,o.default)(".about-menu li#menu_"+(0,o.default)(e[n]).attr("id")).addClass("active"):(0,o.default)(".about-menu li#menu_"+(0,o.default)(e[n]).attr("id")).removeClass("active");200<document.body.scrollTop||200<document.documentElement.scrollTop?document.getElementById("scrollToTop").style.display="block":document.getElementById("scrollToTop").style.display="none"}),(0,o.default)(document).on("click",'a[href^="#"]',function(t){t.preventDefault(),(0,o.default)("html, body").animate({scrollTop:(0,o.default)(o.default.attr(this,"href")).offset().top},500)}),(0,o.default)(document).on("click","#scrollToTop",function(t){t.preventDefault(),(0,o.default)("html, body").animate({scrollTop:0},500)}))},{"./layout_vars":9,jquery:"jquery"}],3:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=(t=t("jquery"))&&t.__esModule?t:{default:t};var o="accordion:toggle";function a(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:200,t=(0,r.default)(t);e?(t.addClass("accordion_expand"),t.find(".accordion__content").slideDown(n)):(t.removeClass("accordion_expand"),t.find(".accordion__content").slideUp(n))}(0,r.default)("body").on("click",".accordion__title",function(){var t=(0,r.default)(this).closest(".accordion"),e=!t.hasClass("accordion_expand");a(t,e),t.trigger(o,e)}),n.default={EVENT_TOGGLE:o,toggle:a}},{jquery:"jquery"}],4:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=u(t("jquery")),r=t("liquidjs"),l=u(t("../tools/tree")),i=t("../tools/date"),c=u(t("../tools/pluralize")),o=t("./layout_vars"),s=u(t("./accordion"));function u(t){return t&&t.__esModule?t:{default:t}}var d,f,p=new r.Liquid,t="default"===(0,o.getLayoutVars)().layout,y="sf"===(0,o.getLayoutVars)().type,m=y?"person_sf/":"person/",h=y?"https://docs.google.com/forms/d/e/1FAIpQLScWdkT2GB6btR3duE5fWRzbTeg8HeLji8MR7ZW2-0oMiG7-Wg/":"https://docs.google.com/forms/d/e/1FAIpQLSd6WGVWRwdwf7Q7oE_3RIlHR8MMdo_LVOnC0nk9YINtfYvjPw/",g=null,v=null,b=new Set,w=0;function _(){d.hide(),d.html(""),v=g=null,w=0,b.clear(),window.dispatchEvent(new Event("closeCard")),window.history&&window.history.pushState&&window.history.pushState("backward",null,y?"./sf":"./")}function x(){var t=g,e=t.depInfo,n=t.depRating,r=t.depLobbys,o=t.lobby_list;t.declarations;d.html(p.renderSync(f,{selectedLaw:v,info:e,rating:n,lobbys:r,lastUpdate:(0,i.formatDate)(e.last_import),fractionClass:{"Единая Россия":"er","КПРФ":"kprf","ЛДПР":"ldpr","Справедливая Россия":"sr","Новые люди":"nl"}[e.fraction]||"vne",positionHtml:(y?function(t){var e=t.committee,n=t.gender,r=t.region.genitive,o=t.goverment_body,a=t.position;"0"!==e&&null!=e&&""!==e||(e="");n=n?n.toLowerCase():"м",o=(o=(o=o.replace("исполнительный ","исполнительным ")).replace("законодательный ","законодательным ")).replace("орган ","органом "),o+=", ";a+=e.replace("Комитет "," ");" "!==e&&(a+=", ");e="ж"==n||"f"==n?"делегирована ":"делегирован ",n="в Совете Федерации с "+t.start_year+" года";return a+e+o+n+". Представитель "+r}:function(t){var e=t.committee||"",n=t.election_method,r=t.convocations.length||1,t=t.gender?t.gender.toLowerCase():"м",o=e.replace("Комитет ГД ","Член комитета ");e&&(o+=", ");e="ж"==t||"f"==t?"избрана":"избран",t=2==r||3==r||4==r?" раза":" раз";return o+e+("одномандатный округ"==n?" по одномандатному округу":" по списку")+", "+(1==r?e+" впервые":e+" "+r+t)})(e),tempComissionHtml:y?function(t){t=(t||[]).map(function(t){return"<li>"+t.charAt(0).toUpperCase()+str.slice(1)+"</li>"});return t.length?"<ul>"+t.join("")+"</ul>":""}(e.temp_commission):"",lawTextBringHtml:(0,c.default)(+n.vnes,"закон<br>выдвинут","закона<br>выдвинуто","законов<br>выдвинуто"),lawTextPassed:(0,c.default)(+n.podpis,"принят","принято","принято"),lawTextDay:(0,c.default)(Math.floor(String(n.sred_day).replace(",",".")),"день","дня","дней"),sredDay:Math.floor(String(n.sred_day).replace(",",".")),lobbyHtml:function(t,n){var e=[],r=(t.forEach(function(t){t=l.default.findAncestors(t,n);e.push(t.map(function(e){return n.find(function(t){return t.id==e}).name}))}),"");e.length&&e.forEach(function(t,e,n){0!==e&&t[0]===n[e-1][0]||(r+="<h3>"+t[0].toLowerCase().replace(" лобби","")+"</h3>"),t=t.slice(1),r+="<ul>";e=(null==(n=t[0])||null==(e=n.charAt(0))?void 0:e.toUpperCase())+(null==(n=t[0])?void 0:n.slice(1));r+="<li>"+e+"</li>",t=t.slice(1),r+='<div class="content"><ul>',t.forEach(function(t,e,n){t=t.charAt(0).toUpperCase()+t.slice(1),r+="<li>"+t+"</li>"}),r+="</ul></div></ul>"});return'<div class="card__lobby-matrix">'+r+"</div>"}(e.groups,o),twPerson:"https://twitter.com/intent/tweet?url=http%3A%2F%2Fdumabingo.ru/"+m+e.person+"&text="+e.fullname,vkPerson:"http://vk.com/share.php?url=http%3A%2F%2Fdumabingo.ru/"+m+e.person,openDeclaration:"https://declarator.org/person/"+e.person,sendForm:h+"viewform?entry.742555963="+e.fullname})),v||d.find(".accordion").each(function(){var t=(0,a.default)(this).attr("data-id");b.has(t)&&s.default.toggle(this,!0,0)}),w&&d.scrollTop(w)}t&&(r=(d=(0,a.default)("#card")).find("#card_template").html(),f=p.parse(r),d.html(""),d.on("click","#scrollToTop",function(t){t.preventDefault(),d.animate({scrollTop:0},500)}),d.on("scroll",function(){200<d.scrollTop()?d.find("#scrollToTop").show():d.find("#scrollToTop").hide()}),d.on(s.default.EVENT_TOGGLE,".card__main-info .accordion",function(t,e){var n=(0,a.default)(this).attr("data-id");e?b.add(n):b.delete(n)}),d.on("click",".card__law-details-button",function(t){t.preventDefault();t=(0,a.default)(this).closest(".card__law").attr("data-id");v=t,w=d.scrollTop(),x()}),d.on("click",".card__law-back-button",function(t){t.preventDefault(),v=null,x()}),d.on("click","#close_btn",_),(0,a.default)(window).on("popstate",_)),n.default=function(t,e,n,r,o){window.history&&window.history.pushState&&window.history.pushState({person:t.person},null,(y?"./sf#id":"./#id")+t.person),g={depInfo:t,depRating:e,depLobbys:n,lobby_list:r,declarations:o},w=0,d.show(),x()}},{"../tools/date":12,"../tools/pluralize":13,"../tools/tree":16,"./accordion":3,"./layout_vars":9,jquery:"jquery",liquidjs:"liquidjs"}],5:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(){var Q,Z,$,e,J,K,tt,et,nt,l,i,rt,ot,at,lt,it,ct=(0,o.default)("gates_tooltip",240),c=window.location.hash?window.location.hash.substring(1):null;function s(){var t=document.getElementById("scrollytelling");t.style.opacity=0,document.documentElement.style.overflowY="auto",setTimeout(function(){t.style.display="none"},200)}function n(){var t=600/(i.width/i.height),e=ft.select("#root").append("svg"),a=(e.attr("viewBox",[0,0,600,20+t]),e.append("g")),t=(Math.PI,Math.sqrt(5),l.slice().sort(function(t,e){return t.dupelganger-e.dupelganger}).sort(function(t,e){return t.id-e.id}));t.length;function n(e){0;function t(t){return 1===e?1===t.group?"tellingCircle":"tellingCircleGray":2===e?11593===t.group?"tellingCircle":"tellingBluredCircle":3===e?11551===t.group||11739===t.group?"tellingCircle":"tellingBluredCircle":4!==e?"tellingCircle":10528===t.id?"tellingCircleAlt":10724===t.id?"tellingCircle":"tellingBluredCircle"}var n=u.default.updater(e),r=n.deps,n=n.labels,o=ft.transition().duration(300).ease(ft.easeLinear),r=a.selectAll("circle").data(r,function(t){return t.unq}),r=(r.enter().append("circle").attr("cx",function(t){return t.x}).attr("cy",function(t){return t.y}).attr("class",t).attr("r",3).attr("name",function(t){return t.name+" "+t.unq}),r.exit().transition(o).attr("r",0),r.exit().transition().delay(1e3).remove(),r.transition(o).attr("r",3).attr("class",t).attr("name",function(t){return t.name+" "+t.unq}).attr("cx",function(t){return t.x}).attr("cy",function(t){return t.y}),a.selectAll("text").data(n,function(t){return t.text}));r.enter().append("text").text(function(t){return t.text}).attr("x",function(t){return t.x}).attr("y",function(t){return t.y}).attr("class","tellingLabel").attr("fill","black"),r.exit().remove(),r.transition(o).attr("x",function(t){return t.x}).attr("y",function(t){return t.y})}ft.nest().key(function(t){return t.cluster}).rollup(function(t){return{count:t.length,name:t[0]&&t[0].clusterName}}).entries(t).slice().sort(function(t,e){return e.value.count-t.value.count}).slice(1,10).forEach(function(t,e){return t.order=e}),u.default.setDeps(t),n(c?4:0);e=document.getElementsByClassName("section");var r=Array.prototype.map.call(e,function(t,e){if("DIV"===t.nodeName)return{i:e,offsetTop:t.offsetTop,offsetHeight:t.offsetHeight}}).reverse(),o=document.getElementById("scrollytelling"),t=(o.addEventListener("scroll",function(){var t=r.find(function(t){return t.offsetTop-o.getBoundingClientRect().height+100<o.scrollTop});if(t){var e=t.i;if(t&&null!=e)switch(e){case 0:0;case 1:case 2:case 3:u.default.setDonutRadius(0),n(e);break;case 4:u.default.setHalf(0),n(e)}}}),c&&s(),document.getElementById("close_cross")),e=document.getElementById("go_to_lobby_map");t.addEventListener("click",function(t){s()}),e.addEventListener("click",function(t){s()})}function st(){var t=document.getElementsByTagName("header")[0].clientHeight,e=document.getElementById("controls").clientHeight,t=t+document.getElementsByClassName("footer")[0].clientHeight+e-document.getElementsByClassName("extra")[0].clientHeight,e=(document.body.className+=" chart",document.body.className="chart",document.documentElement.clientWidth),t=document.documentElement.clientHeight-t;rt=e<=812?812:e,!ut()&&90!=window.orientation||(rt=e),ot=t-5,window.orientation,ft.select("#clusters svg#chart").attr("height",ot).attr("width",rt),ft.select("#clusters svg#chart").attr("viewBox","-100 0 1200 600").attr("preserveAspectRatio","xMidYMid meet").attr("class","desktop"),at=800,lt=600}function ut(){return document.documentElement.clientWidth<=450}function r(){var i=nt.filter(function(t){return t}),I=(i.sort(function(t,e){return e.count-t.count}),i.sort(function(t,e){return t.clusterParent-e.clusterParent}),et.concat(i)),D=ft.scaleLinear().domain([0,8]).range([50,at]),N=ft.scaleLinear().domain([0,8]).range([100,lt]);function e(e){var t=i.find(function(t){return t.cluster==e});return{x:D(t.col),y:N(t.row)}}i[0].col=0,i[0].row=0,i.forEach(function(t){var e=t;switch(e.clusterParent){case 11739:e.col=.2,e.row=1.7,tt&&(e.col=8.9,e.row=1.4);break;case 11679:e.col=4.6,e.row=2.2,tt&&(e.col=.2,e.row=1.7);break;case 11593:e.col=8.9,e.row=1.4,tt&&(e.col=4.6,e.row=2.2);break;case 11550:e.col=1.9,e.row=5.5;break;case 11727:e.col=8.5,e.row=5.9;break;default:e.col=6.4,e.row=6.1}11738==e.cluster&&(e.col=4.5,e.row=6.5)}),it.append("g").attr("class","encloses"),$.forEach(function(e){it.select("g.encloses").append("path").attr("class","enclose").attr("fill","none").attr("id","enclose"+e.id),it.select("g.encloses").append("text").attr("id","encloseText"+e.id).attr("dy",-7.5).append("textPath").attr("xlink:href","#enclose"+e.id).attr("startOffset","25%").style("text-anchor","middle").text(function(){var t=e.alias.toUpperCase();return t=t.charAt(0).toUpperCase()+t.slice(1)})});for(var n,r,t=ft.forceX(function(t){return e(t.cluster).x}),o=ft.forceY(function(t){return e(t.cluster).y}),a=0,l=ft.forceSimulation().nodes(et.sort(function(t,e){return t.cluster-e.cluster})).force("collide",function(t){var e=ft.quadtree().x(function(t){return t.x}).y(function(t){return t.y}).addAll(et);et.forEach(function(s){var t=s.r+Math.max(3,15),u=s.x-t,d=s.x+t,f=s.y-t,p=s.y+t;e.visit(function(t,e,n,r,o){var a,l,i,c;return t.data&&t.data!==s&&(a=s.x-t.data.x,l=s.y-t.data.y,(i=Math.sqrt(a*a+l*l))<(c=s.r+t.data.r+(s.cluster===t.data.cluster?3:15)))&&(s.x-=a*=i=(i-c)/i*.5,s.y-=l*=i,t.data.x+=a,t.data.y+=l),d<e||r<u||p<n||o<f})})}).force("cluster",function(l){et.forEach(function(e){var t,n,r,o,a=i.find(function(t){return t.cluster==e.cluster});a!==e&&(t=e.x-a.x,n=e.y-a.y,(r=Math.sqrt(t*t+n*n))!==(o=e.r+a.r))&&(e.x-=t*=r=(r-o)/r*l,e.y-=n*=r,a.x+=t,a.y+=n)})}).force("x",t.strength(.1)).force("y",o.strength(.1)).alphaDecay(.04).on("end",function(){0==a&&W.alpha(1).restart(),a=1}).stop(),c=0,z=Math.ceil(Math.log(l.alphaMin())/Math.log(1-l.alphaDecay()));c<z;++c)l.tick();var W=ft.forceSimulation().nodes(i.filter(function(t){return 10<t.count})).force("gravity1",ft.forceManyBody(-10).distanceMax(50).distanceMin(0)).alpha(0).on("tick",function(){s.attr("transform",function(t){return"translate("+t.x+" "+t.y+")"})}),f=it.append("g").datum(et).selectAll(".circle").data(function(t){return t}).enter().append("circle").attr("r",function(t){return t.r}).attr("class",function(t){return t.color}).attr("cx",function(t){return t.x}).attr("cy",function(t){return t.y}).on("mouseover",function(e){e.id!=d&&(u=!1);ft.select("#card").classed("is-active");(function(t){var e=t.cluster;s.filter(function(t){return t.cluster==e}).classed("hovered",!0)})(e),L(e);var t=Z.find(function(t){return t.id===e.clusterMin}),n="";Array.isArray(e.cloneClusters)&&(n=e.cloneClusters.map(function(e){return Z.find(function(t){return t.id==e})}));q(),B(e.id);var r='<span class="name">'+e.name+" </span><br/>";r+=tt?'<span class="value">'+e.fraction+", "+e.total_years+" "+(0,wt.default)(e.total_years,"год в СФ","года в СФ","лет в СФ")+"</span><br/>":'<span class="value">'+e.fraction+", "+e.convocations+" "+(0,wt.default)(e.convocations,"созыв","созыва","созывов")+"</span><br/>";""==n&&(r+='<span class="value">'+t.name+"</span><br/>");""!=n&&(r+='<span class="value">'+n.map(function(t){return t.name})+"</span><br/>");ct.showTooltip(r,ft.event)}).on("mouseout",function(t){ft.select("#card").classed("is-active");u||(it.select("g.links").remove(),q());ct.hideTooltip(),s.classed("hovered",!1)}).on("click",S),s=it.append("g").datum(i).selectAll(".g").data(function(t){return t}).enter().append("g").attr("class","lobby_label").style("opacity",0).attr("x",function(t){return t.x}).attr("y",function(t){return t.y}).attr("transform",function(t){return"translate("+t.x+" "+t.y+")"}).each(function(e){var t=Z.find(function(t){return e.clusterName==t.name}).alias;ft.select(this).append("text").text(t.charAt(0).toUpperCase()+t.slice(1)).each(H).each(R)}),u=!1,d=!1,p=ft.select("#clusters > svg#chart"),V=ft.select("svg#chart > g").attr("class","all"),y=1,m=ft.zoomIdentity.translate(0,0).scale(1),h=ft.zoom(),t=document.getElementById("chart").viewBox.baseVal.width,o=document.getElementById("chart").viewBox.baseVal.height,g=document.getElementById("chart").viewBox.baseVal.x,v=document.getElementById("chart").viewBox.baseVal.y,b=ut()?10:5;function R(){var t=this.getBBox().width+4,e=this.getBBox().height,n=this.getBBox().x-2,r=this.getBBox().y;ft.select(this.parentNode).insert("rect","text").attr("x",n).attr("y",r).attr("width",t).attr("height",e).attr("class","backForLabel")}function H(){for(var t,e=ft.select(this),n=e.text().split(/\s+/).slice(0,3).reverse(),r=[],o=e.text(null).attr("y",-n.length/2+"em");t=n.pop();)r.push(t),o.text(r.join(" ")),50<o.node().getComputedTextLength()&&(r.pop(),o.text(r.join(" ")),r=[t],o=e.append("tspan").attr("x",0).attr("dy","1em").text(t))}h.scaleExtent([1,b]).translateExtent([[g,v],[t,o]]).extent([[g,v],[t,o]]).on("zoom",function(){gt.default.zoom_actions(V,y,p)}).on("end",function(){y=ft.event.transform.k,gt.default.zoomEndFunction(s,i,h,tt)}),ft.select("#zoom-in").on("click",function(){ft.event.preventDefault(),h.scaleBy(p.transition().duration(400),1.3)}),ft.select("#zoom-out").on("click",function(){ft.event.preventDefault(),h.scaleBy(p.transition().duration(400),1/1.3)}),ft.select("#zoom-home").on("click",function(){ft.event.preventDefault(),gt.default.zoom_reset(s,p,h,m)}),p.call(h).on("wheel.zoom",null),window.onresize=function(t){st()},C(),M("select_committees","Комитет","committees"),M("select_position_gd","Должность в ГД","positions"),M("select_region","Регион","region");var b=document.getElementById("convocations"),g=document.getElementById("age"),U=(_=pt.default.create(b,{start:[tt?0:1,j()],step:1,connect:!0,range:{min:tt?0:1,max:j()},format:{from:function(t){return parseInt(t)},to:function(t){return parseInt(t)}}}),[document.getElementById("slider-snap-value-lower"),document.getElementById("slider-snap-value-upper")]),F=(x=pt.default.create(g,{start:[k(),E()],step:1,connect:!0,range:{min:k(),max:E()},format:{from:function(t){return parseInt(t)},to:function(t){return parseInt(t)}}}),[document.getElementById("age-slider-snap-value-lower"),document.getElementById("age-slider-snap-value-upper")]),w=(_.on("update",function(t,e){U[e].innerHTML=t[e]}),x.on("update",function(t,e){F[e].innerHTML=t[e]}),x.on("change",function(t,e){P()}),_.on("change",function(t,e){P()}),document.getElementById("search"));new yt.default(w,{list:J.map(function(t){return t.fullname})}),w.addEventListener("awesomplete-highlight",function(t){w.value=t.text.value,P()}),w.addEventListener("awesomplete-selectcomplete",function(t){P()}),ft.selectAll("#presets-first a").nodes().forEach(function(t){t.id;var e=t.getAttribute("data-lobby"),n=t.getAttribute("data-age_min"),r=t.getAttribute("data-age_max"),o=t.getAttribute("data-conv_min"),a=t.getAttribute("data-conv_max"),l=t.getAttribute("data-method"),i=t.getAttribute("data-comittee"),c=t.getAttribute("data-gender"),s=t.getAttribute("data-fio"),u=t.getAttribute("data-fraction"),d=t.getAttribute("data-power");t.addEventListener("click",function(t){t.preventDefault(),O(),n&&r&&x.set([n,r]),o&&a&&_.set([o,a]),l&&ft.select('#method button[value="'+l+'"]').classed("is-active",!0),u&&ft.selectAll("#fraction button").classed("is-active",!1),ft.select('#fraction button[value="'+u+'"]').classed("is-active",!0),i&&ft.select("select#select_committees").property("value",i),c&&ft.select('#gender button[value="'+c+'"]').classed("is-active",!0),s&&ft.select("input#search").property("value",s),e&&ft.select("select#select_lobby").property("value",+e),d&&ft.select('#power button[value="'+d+'"]').classed("is-active",!0),P()})}),Z.forEach(function(t){null==t.parent&&(t.parent=1)}),Z.push({id:1,name:"root",parent:"0"});var _,x,v=vt.default.list_to_tree(Z.sort(function(t,e){return t.order-e.order})),t=[],v=(vt.default.tree_to_collection(v[0],"children",{},t),ft.select("#controls").select("select#select_lobby").on("change",P));function M(t,e,n){var r=[];Q.forEach(function(t){var e=t[n];Array.isArray(e)?e.forEach(function(t){r.push({key:t})}):r.push({key:t[n]})});var o=ft.nest().key(function(t){return t.key}).entries(r).flatMap(function(t){return t.key}).sort(ft.ascending),t=ft.select("#controls").select("select#"+t).on("change",P);t.append("option").text(e).attr("value",-1),t.selectAll("option.opt").data(o).enter().append("option").attr("value",function(t){return t}).text(function(t){return"committees"==n?t&&t.replace("Комитет ГД п","П"):t})}function j(){return tt?Math.max.apply(Math,_t(Q.map(function(t){return+t.total_years}))):Math.max.apply(Math,_t(Q.map(function(t){return+t.convocations})))}function k(){return Math.min.apply(Math,_t(Q.map(function(t){return+t.age})))}function E(){return Math.max.apply(Math,_t(Q.map(function(t){return+t.age})))}function A(t){return document.querySelector(t).viewBox.baseVal}function G(e){if(e){var t=ft.select("#enclose"+e);if(!t.node()){var n=et.find(function(t){return t.cluster==e||t.clusterMin==e}),r=Z.find(function(t){return t.id==n.clusterParent});if(!r)return;if(t=ft.select("#enclose"+r.id),p.attr("data-current_enclose")==r.id)return;p.attr("data-current_enclose",r.id)}e=t,ot=ut()?document.documentElement.clientHeight-80:A("svg#chart").height,rt=A("svg#chart").width,r=e.attr("transform"),(t=document.createElementNS("http://www.w3.org/2000/svg","g")).setAttributeNS(null,"transform",r);var o=(t=[(r=t.transform.baseVal.consolidate().matrix).e,r.f])[0],a=t[1],l=e.node().getBBox(),l=[[l.x+o,l.y+a],[l.x+o+l.width,l.y+a+l.height]],i=l[1][0]-l[0][0],c=l[1][1]-l[0][1],o=(l[0][0]+l[1][0])/2,a=(l[0][1]+l[1][1])/2,l=Math.max(1,Math.min(5,.9/Math.max(i/rt,c/ot))),i=[rt/2-l*o-30,ot/2-l*a+30],t=ft.zoomIdentity.translate(i[0],i[1]).scale(l);p.transition().duration(450).call(h.transform,t)}}function P(t){(0,dt.default)(".hero-body").removeClass("is-loading");var e,n,r,o,a,l=ft.select("input#search").property("value"),i=ft.select("select#select_lobby").property("value"),c=(tt&&(e=ft.select("select#select_region").property("value")),-1!=i&&""!=i&&G(i),ft.select("select#select_committees").property("value")),s=_.get(),u=x.get(),d=(null!=ft.selectAll("#fraction .is-active").node()&&1==ft.selectAll("#fraction .is-active").size()&&(n=ft.select("#fraction .is-active").property("value")),null!=ft.selectAll("#method .is-active").node()&&(r=ft.select("#method .is-active").property("value")),null!=ft.selectAll("#gender .is-active").node()&&(o=ft.select("#gender .is-active").property("value")),tt&&null!=ft.selectAll("#power .is-active").node()&&(a=ft.select("#power .is-active").property("value")),f.filter(function(t){return(""==l||t.name.toLowerCase().includes(l.toLowerCase())||t.clusterName.toLowerCase().includes(l.toLowerCase()))&&(-1==i||!i||t.cluster==i||t.cloneClusters.includes(+i)||t.clusterParent==i||t.clusterMin==i||t.clusterParentMiddle==i)&&(!tt||!e||-1==e||t.region==e)&&(-1==c||t.committees.includes(c))&&(!!tt||+t.convocations>=+s[0]&&+t.convocations<=+s[1])&&(!tt||+t.total_years>=+s[0]&&+t.total_years<=+s[1])&&+t.age>=+u[0]&&+t.age<=+u[1]&&(!n||n==t.fraction||n==t.fraction_sf)&&(!r||t.election_method==r)&&(!o||t.gender==o)&&(!a||t.goverment_body==a)}));d.size()!=f.size()?t||ft.select("#clear").classed("is-hidden",!1):ft.select("#clear").classed("is-hidden",!0),Y(d)}function Y(r){var o=f.size(),a=o,l=ft.transition().duration(10).ease(ft.easeLinear);f.classed(function(t){return t.color},!0).transition().style("opacity",.2).on("end",function(){var e,t,n;0===--a&&0<--o&&(r.transition(l).style("opacity",1),s.transition().style("opacity",0),e=r.data().map(function(t){return t.cluster}),t=i.filter(function(t){return e.includes(t.cluster)}),n=(0,ht.default)(t,y,tt).map(function(t){return t.cluster}),s.filter(function(t){return e.includes(t.cluster)}),s.filter(function(t){return n.includes(t.cluster)}).transition().style("opacity",1))})}function O(){ft.select("#clear").classed("is-hidden",!0),p.attr("data-current_enclose",null),_.reset(),x.reset(),ft.selectAll("#search").property("value",""),ft.selectAll("#controls button").classed("is-active",!1),ft.selectAll("#controls #fraction button").classed("is-active",!0),ft.selectAll("select").property("selectedIndex",0),f.classed(function(t){return t.color},!0).transition().style("opacity",1);var e=(0,ht.default)(i,y,tt).map(function(t){return t.cluster});s.style("opacity",0).filter(function(t){return e.includes(t.cluster)}).transition().style("opacity",1),gt.default.zoom_reset(s,p,h,m)}function C(){$.forEach(function(e){var t,n=it.select("path.enclose#enclose"+e.id),r=I.filter(function(t){return t.clusterParent==e.id}),r=ft.packEnclose(r);r&&(t=ft.arc().innerRadius(Math.max(50,r.r)).outerRadius(Math.max(50,r.r)).startAngle(3.14/180*-180).endAngle(3.14/180*180),n.transition().duration(100).attr("transform","translate("+r.x+","+r.y+")").attr("d",t()))}),f.attr("cx",function(t){return t.x}).attr("cy",function(t){return t.y}),s.attr("transform",function(t){return"translate("+t.x+" "+t.y+")"}),n&&r.attr("x1",function(t){return t.source.x}).attr("y1",function(t){return t.source.y}).attr("x2",function(t){return t.target.x}).attr("y2",function(t){return t.target.y})}function S(t){u=!0,d=t.id,q(),L(t),B(t.id),e=t.id,T(),f.filter(function(t){return t.id==e}).classed("activeCircle",!0),(0,dt.default)("#clusters").addClass("is-loading");var e,n,r=function(e){var t=K.find(function(t){return t.id_declarator==e}),n=ft.max(K.map(function(t){return+t.podpis/(+t.vnes+t.podpis)*10+1}));t||((t=new Object).no=!0,t.vnes=-1,t.podpis=-1,t.sred_day=-1);var n=[1,n],n=ft.scaleLog().domain(n).range([4,10]),r=1;t.no||(r=t.podpis/(t.podpis+t.vnes)*10+1);t.vnes<5&&(r=1);t.no&&(r=1);n=n(r);return t.log=n,t}(t.person),o=(a=t.groups,n="",a.forEach(function(e,t){0<t&&(n+=", "),n+=Z.find(function(t){return t.id==e}).name}),n),a=(0,bt.getLayoutVars)().isProd?"":"https://cors-anywhere.herokuapp.com/",t=a+"https://declarator.org/api/v1/search/sections/?person="+t.person;Promise.all([ft.json(a+"https://declarator.org/api/lobbist/10001"),ft.json(t)]).then(function(t){e=2;var t=function(t){if(Array.isArray(t))return t}(t=t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,a,l,i=[],c=!0,s=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(i.push(r.value),i.length!==e);c=!0);}catch(t){s=!0,o=t}finally{try{if(!c&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(s)throw o}}return i}}(t,e)||xt(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),e=t[0],t=t[1];(0,dt.default)("#clusters").removeClass("is-loading"),new mt.default(e,r,o,Z,t)})}function B(e){f.filter(function(t){return t.id===e}).attr("stroke","#000").attr("stroke-width","2px")}function q(){f.attr("stroke","none")}function T(){f.classed("activeCircle",!1)}function L(e){var t=et.filter(function(t){return t.id==e.id}).map(function(t){return{source:e.uniq,target:t.uniq,value:1}});n=t.map(function(t){return Object.create(t)}),it.select("g.links").remove(),r=it.insert("g",":first-child").classed("links",!0).attr("stroke","#999").selectAll("line").data(n).enter().append("line").attr("stroke-width",function(t){return Math.sqrt(t.value)}),l.force("link",ft.forceLink(n).id(function(t){return t.uniq}).strength(0)),C()}ft.selectAll(".buttons button").on("click",function(){ft.select(this).attr("value");var t=ft.select(this.parentNode).selectAll("button");ft.select(this).classed("is-active")?"fraction"!=ft.select(this.parentNode).attr("id")?ft.select(this).classed("is-active",!1):(1<ft.select(this.parentNode).selectAll("button.is-active").size()?t.classed("is-active",!1):t.classed("is-active",!0),ft.select(this).classed("is-active",!0)):(t.classed("is-active",!1),ft.select(this).classed("is-active",!0)),P()}),v.append("option").text("Группа интересов").attr("value",-1),v.selectAll("option.opt").data(t).enter().append("option").classed("opt",!0).attr("value",function(t){return t.id}).text(function(t){var e,n=+t.level;return 0==n&&(e=" "),1==n&&(e="    "),2==n&&(e="        "),0==n?e+t.name.toUpperCase():e+t.name}).each(function(t){0==t.level&&((t=document.createElement("option")).disabled=!0,this.nextSibling)&&this.parentNode&&this.parentNode.insertBefore(t,this)}).each(function(e){0==et.filter(function(t){return t.cluster==e.id||t.clusterParent==e.id||t.clusterParentMiddle==e.id||t.clusterMin==e.id}).length&&(ft.select(this).property("disabled",!0),ft.select(this).remove())}),P("init"),ft.select("#search").on("keyup",P),ft.select("#clear").on("click",O);var X=window.location.hash;X&&(o=et.find(function(t){return t.person==X.replace("#id","")}))&&(u=!0,S(o),f.classed(function(t){return t.color},!0).transition().style("opacity",1)),window.addEventListener("closeCard",function(){it.select("g.links").remove(),q(),T(),u=!1})}a.default.then(function(t){var s,u;Q=t.data,Z=t.lobby,$=t.lobby_level_0,t.myGroups,e=t.myArrGroups,J=t.rawDep,K=t.rawRating,tt=t.isSF,it=ft.select("#clusters").append("svg").attr("id","chart").append("g"),st(),Q.length,t=e.length,s=ft.scaleOrdinal().domain(["Единая Россия","ЛДПР","КПРФ","Справедливая Россия"]).range(["is-color-er","is-color-yellow","is-color-red","is-color-orange"]).unknown("is-color-gray"),ft.scaleSequential(ft.interpolateRainbow).domain(ft.range(t)),nt=new Array(t),u=0,(et=Q.map(function(e){var t,n,r,o,a=Z.find(function(t){return t.id===e.group}),l=(0==a.level&&(n=a.id),1==a.level&&(n=Z.find(function(t){return t.id==a.parent}).id),2==a.level&&(n=Z.find(function(t){return t.id==Z.find(function(t){return t.id==a.parent}).parent}).id,r=Z.find(function(t){return t.id==a.parent}).id,o=Z.find(function(t){return t.id==a.parent}).name),+e.group),i=r||l,c=e.rating,e=(d(t={person:e.person,name:e.name,fraction:e.fraction,fraction_sf:e.fraction_sf,id:e.id},"person",e.person),d(t,"groups",e.groups),d(t,"gender",e.gender),d(t,"age",e.age),d(t,"cluster",r||l),d(t,"clusterMin",l),d(t,"clusterName",r?o:a.name),d(t,"clusterLevel",a.level),d(t,"clusterParent",n),d(t,"clusterParentMiddle",r||null),d(t,"color",s(e.fraction)),d(t,"election_method",e.election_method),d(t,"committees",e.committees),d(t,"convocations",e.convocations),d(t,"uniq",u++),d(t,"r",e.rating),d(t,"region",e.region),d(t,"goverment_body",e.goverment_body),d(t,"total_years",e.total_years),d(t,"x",+rt/2+Math.random()),d(t,"y",+ot/2+Math.random()),t),l=0,l=nt[i]?nt[i].count+1:1;return(!nt[i]||c>nt[i].r)&&(nt[i]=e),nt[i].count=l,e})).sort(function(t,e){return e.count-t.count}),et.sort(function(t,e){return t.clusterParent-e.clusterParent}),et.forEach(function(e){e.cloneClusters="null";var n=et.filter(function(t){return t.id==e.id&&t.cluster==e.cluster}),t=(1<n.length&&n.forEach(function(t,e){0<e&&(t.clone="yes"),t.cloneClusters=n.map(function(t){return t.clusterMin})}),et.filter(function(t){return t.id==e.id}));1<t.length&&t.forEach(function(t,e){t.dupelganger=0<e?1:0}),e.hasClones=1<t.length?1:0}),et=(l=et).filter(function(t){return"yes"!=t.clone}),tt&&!c&&((t=document.getElementById("scrollytelling")).style.display="block",i=t.getBoundingClientRect(),n()),r()})};var dt=r(t("jquery")),ft=function(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!=typeof t)return{default:t};e=l(e);if(e&&e.has(t))return e.get(t);var n,r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in t){var a;"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&((a=o?Object.getOwnPropertyDescriptor(t,n):null)&&(a.get||a.set)?Object.defineProperty(r,n,a):r[n]=t[n])}r.default=t,e&&e.set(t,r);return r}(t("d3")),pt=r(t("nouislider")),yt=r(t("awesomplete")),o=r(t("../vendor/tooltip")),a=r(t("./data")),u=r(t("../tools/storyTelling")),mt=r(t("./card")),ht=r(t("../tools/showed_clusters")),gt=r(t("../tools/zoom")),vt=r(t("../tools/tree")),bt=t("./layout_vars"),wt=r(t("../tools/pluralize"));function l(t){var e,n;return"function"!=typeof WeakMap?null:(e=new WeakMap,n=new WeakMap,(l=function(t){return t?n:e})(t))}function r(t){return t&&t.__esModule?t:{default:t}}function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _t(t){return function(t){if(Array.isArray(t))return c(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||xt(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function xt(t,e){var n;if(t)return"string"==typeof t?c(t,e):"Map"===(n="Object"===(n=Object.prototype.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(t,e):void 0}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function d(t,e,n){(e=function(t){t=function(t,e){if("object"!==i(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===e?String:Number)(t);n=n.call(t,e||"default");if("object"!==i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===i(t)?t:String(t)}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}},{"../tools/pluralize":13,"../tools/showed_clusters":14,"../tools/storyTelling":15,"../tools/tree":16,"../tools/zoom":17,"../vendor/tooltip":18,"./card":4,"./data":6,"./layout_vars":9,awesomplete:"awesomplete",d3:"d3",jquery:"jquery",nouislider:"nouislider"}],6:[function(t,e,n){"use strict";function l(t){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=function(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==l(t)&&"function"!=typeof t)return{default:t};e=i(e);if(e&&e.has(t))return e.get(t);var n,r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in t){var a;"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&((a=o?Object.getOwnPropertyDescriptor(t,n):null)&&(a.get||a.set)?Object.defineProperty(r,n,a):r[n]=t[n])}r.default=t,e&&e.set(t,r);return r}(t("d3")),t=t("./layout_vars");function i(t){var e,n;return"function"!=typeof WeakMap?null:(e=new WeakMap,n=new WeakMap,(i=function(t){return t?n:e})(t))}var o,c,s,r="https://cors-anywhere.herokuapp.com/",u=[],d=[],f=[],p=new Set,y=new Array,m="sf"===(0,t.getLayoutVars)().type,r=((0,t.getLayoutVars)().isProd?"":r)+"https://declarator.org/media/dumps/",r={"duma-7":[r+"lobbist-small-d7.json",r+"lobby-group.json","/assets/data/rating.json","/assets/data/alias.json"],"duma-8":[r+"lobbist-small-d8.json",r+"lobby-group.json","/assets/data/rating.json","/assets/data/alias.json"],sf:[r+"lobbist-small-sf.json",r+"lobby-group.json","/assets/data/rating-sf.json","/assets/data/alias.json"]}[(0,t.getLayoutVars)().type],h=[],t=(r.forEach(function(t){h.push(a.json(t))}),Promise.all(h).then(function(t){o=t[0];var e,r,n=t[1];return c=t[2],s=t[3],t=o,Object.defineProperties(Array.prototype,{flatMap:{value:function(t){return Array.prototype.concat.apply([],this.map(t))},writeable:!1,enumerable:!1}}),u=t.flatMap(function(n){var r=n.groups,o=(0==r.length&&(r=[11851]),Math.floor(6*Math.random()),function(e){var t=c.find(function(t){return t.id_declarator==e}),n=a.max(c.map(function(t){return+t.podpis/(+t.vnes+t.podpis)*10+1}));t||((t=new Object).no=!0,t.vnes=-1,t.podpis=-1,t.sred_day=-1);var n=[1,n],r=m?[8,14]:[4,10],n=a.scaleLog().domain(n).range(r),r=1;t.no||(r=t.podpis/(t.podpis+t.vnes)*10+1);t.vnes<5&&(r=1);t.no&&(r=1);n=n(r);return t.log=n,t}(n.person));return r.map(function(t){p.add(t);var e=m?function(t){if(null===t)return"Вне партии";if(["беспартийный","беспартийная","вне партии"].includes(t.toLowerCase()))return"Вне партии";return t}(n.fraction):n.fraction;return{id:n.id,name:n.fullname,fraction:n.fraction,fraction_sf:e,gender:n.gender,age:(e=new Date(n.birth_date),e=Date.now()-e.getTime(),e=new Date(e),Math.abs(e.getUTCFullYear()-1970)),group:t,groups:r,person:n.person,rating:o.log,election_method:n.election_method,committees:m?"0"!==(e=n.committee)&&null!=e&&""!==e?[e]:["Вне комитетов"]:n.committees,convocations:0!=n.convocations.length?n.convocations.length:1,region:n.region?n.region.name:null,goverment_body:n.goverment_body,total_years:n.total_years}})}),e=0,p.forEach(function(t){y.push({id:e++,val:t})}),s=s.map(function(t){return""==t.alias&&(t.alias="null"),{id:t.id,name:t.name,alias:t.alias}}),r=s,d=n.map(function(e,t){var n=r.find(function(t){return t.name==e.name}),n=n&&"null"!=n.alias?n.alias:e.name;return{index:t,id:e.id,name:e.name,parent:e.parent,order:e.order,level:e.level,tree_id:e.tree_id,alias:n}}),f=d.filter(function(t){return 0==t.level}),{lobby:d,lobby_level_0:f,data:u,rawRating:c,rawDep:o,myGroups:p,myArrGroups:y,isSF:m}}));n.default=t},{"./layout_vars":9,d3:"d3"}],7:[function(t,e,n){"use strict";t=(t=t("jquery"))&&t.__esModule?t:{default:t};var r=(0,t.default)("#header-selector"),o="selector-control_open";r.on("click",function(){r.toggleClass(o)}),(0,t.default)(document).on("click",function(t){var e=r.hasClass(o),t=!r.is(t.target)&&0===r.has(t.target).length;e&&t&&r.toggleClass(o)})},{jquery:"jquery"}],8:[function(t,e,n){"use strict";var r=l(t("jquery")),o=l(t("./chart")),a=t("./layout_vars");function l(t){return t&&t.__esModule?t:{default:t}}(0,r.default)(document).ready(function(){"default"===(0,a.getLayoutVars)().layout&&((0,r.default)(".hero-body").addClass("is-loading"),(0,o.default)())})},{"./chart":5,"./layout_vars":9,jquery:"jquery"}],9:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.getLayoutVars=void 0;n.getLayoutVars=function(){return window.LAYOUT_VARS}},{}],10:[function(t,e,n){"use strict";var r=(t=t("jquery"))&&t.__esModule?t:{default:t};function o(){(0,r.default)("#modal-legend").hide()}(0,r.default)("body").on("click","#button-show-legend",function(){var t=(0,r.default)("#modal-legend");t.css("display","flex"),t.focus()}),(0,r.default)("body").on("click",".legend__modal-close",o),(0,r.default)("body").on("blur","#modal-legend",o)},{jquery:"jquery"}],11:[function(t,e,n){"use strict";(0,((t=t("jquery"))&&t.__esModule?t:{default:t}).default)(document).ready(function(){document.getElementById("nav-toggle").addEventListener("click",function(){var t=document.getElementById("nav-toggle"),e=document.getElementById("header_menu");""==t.className?(t.className="is-active is-visible",e.className="header-menu  is-visible"):(t.className="",e.className="header-menu")})})},{jquery:"jquery"}],12:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.formatDate=function(t){if(t)return new Date(t).toLocaleString(r,{year:"numeric",month:"long",day:"numeric"})};var r="ru-RU"},{}],13:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(t,e,n,r){t=Math.abs(t);if(!(5<=(t%=100)&&t<=20)){if(1==(t%=10))return e;if(2<=t&&t<=4)return n}return r}},{}],14:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(t,e,n){var r,o=[],a=e;a<=1&&(r=5);1<a&&(r=8);1.3<a&&(r=10);2.1<a&&(r=20);3.7<a&&(r=30);return[11550,11593,11679,11727,11739,null].forEach(function(e){11727===e&&n&&a<=1.6&&(r=1),o=o.concat(t.filter(function(t){return t.clusterParent==e}).sort(function(t,e){return e.count-t.count}).slice(0,r).map(function(t){return t.cluster}))}),t.filter(function(t){return o.includes(t.cluster)})}},{}],15:[function(t,e,n){"use strict";function l(t){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;t=function(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==l(t)&&"function"!=typeof t)return{default:t};e=i(e);if(e&&e.has(t))return e.get(t);var n,r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in t){var a;"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&((a=o?Object.getOwnPropertyDescriptor(t,n):null)&&(a.get||a.set)?Object.defineProperty(r,n,a):r[n]=t[n])}r.default=t,e&&e.set(t,r);return r}(t("d3"));function i(t){var e,n;return"function"!=typeof WeakMap?null:(e=new WeakMap,n=new WeakMap,(i=function(t){return t?n:e})(t))}var o=46.5,s=[];function a(t,e){var n;for(e.dist=function(t){var e=t.x,n=t.y,e=(e+=n/2)*e+(n*=Math.sqrt(3)/2)*n+.001*Math.atan2(t.x,t.y);return e=this.half&&(e-=Math.pow(o,2),e=Math.abs(e),.5<n)?1/0:e}.call(this,e),n=0;n<t.length;n++)if(e.dist<t[n].dist){t.splice(n,0,e);break}n==t.length&&t.push(e)}function c(t,e,n){var r=this;this.half=n,this.dist=t,this.center=e,this.data=[],this.stack=[{x:0,y:0,dist:0}],this.half&&(this.stack[0].x=-o-1),this.getPoint=function(t){for(;r.data.length<=t&&0<r.stack.length;){var e=r.stack.shift();[{x:e.x-5,y:+e.y},{x:e.x+5,y:+e.y},{x:+e.x,y:e.y-5},{x:+e.x,y:e.y+5}].filter(function(e){var n=!1;return r.data.forEach(function(t){t.x==e.x&&t.y==e.y&&(n=!0)}),r.stack.forEach(function(t){t.x==e.x&&t.y==e.y&&(n=!0)}),!n}).forEach(function(t){a.call(r,r.stack,t)}),e.transformed=r.transform(e),r.data.push(e)}return r.data[t].transformed},this.transform=function(t){var e=t.x,t=t.y;return e+=t/2,t*=Math.sqrt(3)/2,e*=r.dist,t*=r.dist,{x:e+=r.center.x,y:t+=r.center.y}}}var r,u=[],d=(u[0]=[1],u[1]=[1,11851],u[2]=[11593,11551,11739,11701,11696,11697,11710,11720,11562,11717,11683,11698,11589,11713],u[3]=[11593,11551,11739,11720,11701,11696,11697,11710,11562,11683,11698],u[4]=[11551,11724,11573,11703,11552,11646,11559,11758,11696,11693],{11593:"Регионы",11551:"Силовики",11739:"Крупный бизнес и госкорпорации",11701:"Строительство, девелопмент",11696:"Сельское хозяйство",11697:"Лесное, рыбное хозяйство",11710:"Здравоохранение",11720:"Госуправление",11562:"ФОИВы",11717:"Финансы, банки",11683:"Топливная промышленность",11698:"Транспорт и связь",11589:"Банк России",11713:"Образование и наука",11724:"Адвокаты",11573:"Роскомнадзор",11703:"Телекоммуникации, IT",11552:"ФСБ",11699:"транспорт",11760:"ОАО РЖД",11758:"ГК Ростех",11809:"ГК Росатом",11783:"АО ОСК",11646:"Крым",11559:"МЧС",11693:"Алкоголь",1:"",11851:""}),f=[],p=[],y=0,m={0:1,1:2,2:4,3:4,4:4,5:4};null!==t.select("#scrollytelling").node()&&((r=document.getElementById("scrollytelling")).style.display="block",t=t.select("#scrollytelling").node().getBoundingClientRect(),r.style.display="none",y=600/(t.width/t.height),u.forEach(function(t,o){t.forEach(function(t,e){var n=+m[o],r=y-20*n,e=0===o?{x:300,y:y/2}:{x:e%n*600/n+600/n/2,y:10+((e-e%n)/n*(r/n+30)+r/n/2+10)};f[o]=f[o]||[],f[o][t]=new c(1.5,e,0===o?1:0),p[o]=p[o]||[],p[o][t]=e})}));n.default={updater:function(i){var c=[],n=[];return u[i].forEach(function(o){for(var a=s.filter(function(t){return t.clusterMin===o||t.clusterParentMiddle===o||t.clusterParent===o}),t=(0===i&&(a=s),1===i&&1===o&&(a=s.filter(function(t){return 11851!==t.clusterMin})),d[o]),e=(0!==a.length&&n.push({x:p[i][o].x,y:p[i][o].y-y/m[i]/2,text:t||""}),0),l=-1;e<a.length;e++)!function(t,e){var n=a[t],r=(n.dupelganger?(t=s.find(function(t){return t.id===n.id&&0===t.dupelganger}),(t=(r=a.find(function(t){return t.id===n.id&&t.uniq!==n.uniq&&n.uniq>t.uniq}))?r:t)&&(t.clusterMin===o||t.clusterParentMiddle===o||t.clusterParent===o)||(e++,0!==i&&1!==i)||e--):e++,f[i][o].getPoint(e));c.push({x:r.x,y:r.y,color:"purple",id:n.id,name:n.name,unq:n.uniq,group:o}),l=e}(e,l)}),{deps:c,labels:n}},setDeps:function(t){s=t},setGroups:function(t){0},setHalf:function(t){0},setDonutRadius:function(t){o=t}}},{d3:"d3"}],16:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0,n.default={list_to_tree:function(t){for(var e,n={},r=[],o=0;o<t.length;o+=1)t[n[t[o].id]=o].children=[];for(o=0;o<t.length;o+=1)("0"!==(e=t[o]).parent?t[n[e.parent]].children:r).push(e);return r},tree_to_collection:function t(e,n,r,o){if(e[n]&&0!==e[n].length)for(var a=0;a<e[n].length;a++){var l=e[n][a];r[l.id]=l,o.push(l),t(l,n,r,o)}},findAncestors:function(e,t){for(var n=[e],r=t.find(function(t){return t.id===e}),o=r&&r.parent;1!==o&&null!=o;)n.unshift(o),o=t.find(function(t){return t.id==o}).parent;return n}}},{}],17:[function(t,e,n){"use strict";function l(t){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=function(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==l(t)&&"function"!=typeof t)return{default:t};e=s(e);if(e&&e.has(t))return e.get(t);var n,r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(n in t){var a;"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&((a=o?Object.getOwnPropertyDescriptor(t,n):null)&&(a.get||a.set)?Object.defineProperty(r,n,a):r[n]=t[n])}r.default=t,e&&e.set(t,r);return r}(t("d3")),c=(t=t("./showed_clusters"))&&t.__esModule?t:{default:t};function s(t){var e,n;return"function"!=typeof WeakMap?null:(e=new WeakMap,n=new WeakMap,(s=function(t){return t?n:e})(t))}n.default={zoomEndFunction:function(t,e,n,r){var o=i.event.transform.k,a=(0,c.default)(e,o,r).map(function(t){return t.cluster}),e=t.filter(function(t){return a.includes(t.cluster)});1<o?(i.selectAll(".maxi").style("opacity",0),i.selectAll(".midi").style("opacity",0),i.selectAll(".super").style("opacity",0),t.attr("class","lobby_label"),e.classed("mini",!0),e.transition().style("opacity",1),1.3<o&&(i.selectAll(".mini").style("opacity",0),i.selectAll(".maxi").style("opacity",0),i.selectAll(".super").style("opacity",0),t.attr("class","lobby_label"),e.classed("midi",!0),e.transition().style("opacity",1)),2.1<o&&(i.selectAll(".mini").style("opacity",0),i.selectAll(".midi").style("opacity",0),i.selectAll(".super").style("opacity",0),t.attr("class","lobby_label"),e.classed("maxi",!0),e.transition().style("opacity",1)),3.7<o&&(i.selectAll(".mini").style("opacity",0),i.selectAll(".midi").style("opacity",0),i.selectAll(".maxi").style("opacity",0),t.attr("class","lobby_label"),e.classed("super",!0),e.transition().style("opacity",1))):(i.select("svg#chart").on("zoom",null),i.selectAll(".mini").style("opacity",0),i.selectAll(".midi").style("opacity",0),i.selectAll(".maxi").style("opacity",0),i.selectAll(".super").style("opacity",0),e.transition().style("opacity",1),t.attr("class","lobby_label"))},zoom_actions:function(t,e,n){n.attr("data-current_enclose",null),t.attr("transform",i.event.transform)},zoom_reset:function(t,e,n,r){i.select("svg#chart.desktop").attr("viewBox","-100 0 1200 600"),e.attr("data-current_enclose",null),t.transition().style("opacity",0),e.transition().duration(750).call(n.transform,r)}}},{"./showed_clusters":14,d3:"d3"}],18:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(t,e){var l=d3.select("body").append("div").attr("class","tooltip").attr("id",t).style("pointer-events","none");e&&l.style("width",e);function n(){l.style("opacity",0)}function r(t){var e=l.style("width"),n=l.style("height"),r=window.scrollY,o=window.scrollX,a=document.all?t.clientX+o:t.pageX,t=document.all?t.clientY+r:t.pageY,e=a-o+20+e>window.innerWidth?a-e-20:a+10,a=(e<o+10&&(e=o+10),t-r+20+n>window.innerHeight?t-n-20:t+10);l.style("top",(a=a<r+10?t+10:a)+"px").style("left",e+"px")}return n(),{showTooltip:function(t,e){l.style("opacity",1).html(t),r(e)},hideTooltip:n,updatePosition:r}}},{}]},{},[1]);
//# sourceMappingURL=main-786cb105.js.map
